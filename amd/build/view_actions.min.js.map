{"version":3,"sources":["../src/view_actions.js"],"names":["define","$","mdlconfig","setup","id","each","index","value","currentrating","data","itemid","thisid","barrating","initialRating","theme","onSelect","text","event","ajax","url","wwwroot","method","optionid","done","rate","on","fadeToggle","animate","scrollTop","offset","top","toggle","val","trigger","click","not","prop","checked","change","selected","attr","selectid","replace"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for booking module\n *\n * @module mod_booking/view_actions\n * @package mod_booking\n * @copyright 2017 David Bogner <info@edulabs.org>\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since 3.1\n */\n\ndefine(['jquery', 'core/config', 'mod_booking/jquery.barrating'],\n        function($, mdlconfig) {\n            return {\n                setup : function(id) {\n                    $('.starrating').each(function(index, value) {\n                        var currentrating = $(this).data('current-rating');\n                        var itemid = $(this).data('itemid');\n                        if(!value) {\n                            // Just for stupid TravisCI rules!\n                            value = '';\n                        }\n                        var thisid = this;\n                        $(this).barrating({\n                            initialRating: currentrating,\n                            theme: 'css-stars',\n                            onSelect: function(value, text, event) {\n                                if (typeof(event) !== 'undefined') {\n                                    $.ajax({\n                                        url: mdlconfig.wwwroot + \"/mod/booking/rating_rest.php?id=\" + id,\n                                        method: \"POST\",\n                                        data: { optionid: itemid, value: value }\n                                    }).done(function(data) {\n                                        $(thisid).barrating('readonly', true);\n                                        $(thisid).barrating('set', data.rate);\n                                    });\n                                }\n                            }\n                        });\n                    });\n                    $('#showHideSearch').on('click', function() {\n                        $('#tableSearch').fadeToggle(\"slow\", \"linear\");\n                        $('html, body').animate({\n                            scrollTop : $(\"#tableSearch\").offset().top - 120\n                        }, 1000);\n                    });\n                    $('.showHideOptionText').on('click', function() {\n                        $('#optiontext' + $(this).data(\"id\")).fadeToggle(\"slow\", \"linear\");\n                        $('#showtext' + $(this).data(\"id\")).toggle();\n                        $('#hidetext' + $(this).data(\"id\")).toggle();\n                        $('html, body').animate({\n                            scrollTop : $('#optiontext' + $(this).data(\"id\")).offset().top - 120\n                        }, 1000);\n                    });\n                    $('#page-mod-booking-view #buttonclear')\n                            .on('click',\n                                    function() {\n                                        $('#searchtext, #searchlocation, #searchinstitution, #searchname, #searchsurname')\n                                                .val('');\n                                        $('#searchButton').trigger('click');\n                                    });\n                    $('#page-mod-booking-report #buttonclear')\n                            .on('click',\n                                    function() {\n                                        $('#menusearchwaitinglist, #menusearchfinished, #searchdate')\n                                                .val('');\n                                        $('#searchButton').trigger('click');\n                                    });\n                    $('#page-mod-booking-report #usercheckboxall')\n                            .click(function() {\n                                $('#studentsform input:checkbox').not(this)\n                                        .prop('checked', this.checked);\n                            });\n                    $('#page-mod-booking-report #menuratingall')\n                            .change(function() {\n                                $('#studentsform input:checkbox').not(this)\n                                        .prop('checked', 'checked');\n                                var selected = $(this).val();\n                                $('.booking-option-rating .postratingmenu.ratinginput [value=\"' + selected + '\"]')\n                                        .attr('selected', true);\n                            });\n                    $('#page-mod-booking-report .booking-option-rating .ratinginput')\n                            .change(function() {\n                                var selectid = $(this).attr('id');\n                                var selected = selectid.replace(/\\D/g, '');\n                                $('#studentsform [id=check' + selected + ']')\n                                        .prop('checked', 'checked');\n                            });\n                }\n            };\n        });"],"file":"view_actions.min.js"}
