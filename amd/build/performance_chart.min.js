/**
 * AJAX helper for the inline editing a value.
 *
 * This script is automatically included from template core/inplace_editable
 * It registers a click-listener on [data-inplaceeditablelink] link (the "inplace edit" icon),
 * then replaces the displayed value with an input field. On "Enter" it sends a request
 * to web service core_update_inplace_editable, which invokes the specified callback.
 * Any exception thrown by the web service (or callback) is displayed as an error popup.
 *
 * @module     mod_booking/performance_chart
 * @copyright  2018 David Bogner
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since      3.3
 */
define("mod_booking/performance_chart",["core/chartjs","core/ajax","jquery"],function(Chart,Ajax,$){let chartInstance=null;const createChart=(canvas,data)=>{const labels=data.labels||[],datasets=(data.datasets||[]).map(ds=>({label:ds.label,data:ds.data,backgroundColor:ds.backgroundColor}));return new Chart(canvas.getContext("2d"),{type:"bar",data:{labels:labels,datasets:datasets},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",align:"start",labels:{boxWidth:16,padding:12}},tooltip:{enabled:!0}},scales:{x:{title:{display:!1}},y:{beginAtZero:!0,title:{display:!0,text:"Time (ms)"}}}}})},updateChart=data=>{if(chartInstance)try{const labels=JSON.parse(data.labelsjson),datasets=JSON.parse(data.datasetsjson);chartInstance.data.labels=labels,chartInstance.data.datasets=datasets,chartInstance.update()}catch(e){console.error("Failed to parse new chart data:",e)}else console.warn("Chart not initialized yet")},registerSidebarClicks=()=>{$(".booking-sidebar-item a").on("click",function(e){e.preventDefault();const hash=$(this).data("hash");hash&&Ajax.call([{methodname:"mod_booking_get_performance_chart",args:{value:hash},done:function(response){updateChart(response)},fail:function(error){console.error("Error loading chart data via AJAX",error)}}])})};return{init:(canvasId,dataScriptId)=>{const canvas=document.getElementById(canvasId),dataNode=document.getElementById(dataScriptId);if(!canvas||!dataNode)return;let parsed;try{parsed=JSON.parse(dataNode.textContent)}catch(e){return void console.error("Invalid chart data JSON:",e)}chartInstance=createChart(canvas,parsed),registerSidebarClicks()},updateChart:updateChart}});

//# sourceMappingURL=performance_chart.min.js.map