{"version":3,"file":"bookinginstancetemplateselect.min.js","sources":["../src/bookinginstancetemplateselect.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AJAX helper for the inline editing a value.\n *\n * This script is automatically included from template core/inplace_editable\n * It registers a click-listener on [data-inplaceeditablelink] link (the \"inplace edit\" icon),\n * then replaces the displayed value with an input field. On \"Enter\" it sends a request\n * to web service core_update_inplace_editable, which invokes the specified callback.\n * Any exception thrown by the web service (or callback) is displayed as an error popup.\n *\n * @module     mod_booking/bookinginstancetemplateselect\n * @package\n * @copyright  2019 Andraž Prinčič\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      4.5\n */\n\ndefine(['jquery', 'core/ajax'], function($, ajax) {\n\n    return {\n        init: function() {\n\n            // Put whatever you like here. $ is available\n            // to you as normal.\n            $(\"#id_instancetemplateid\").change(function() {\n                if ($(\"#id_instancetemplateid\").val() != '') {\n                    ajax\n                    .call([{\n                        methodname: 'mod_booking_instancetemplate',\n                        args: {\n                            id: $(\"#id_instancetemplateid\").val()\n                        },\n                        done: function(data) {\n                            var obj = $.parseJSON(data.template);\n\n                            // General\n                            $(\"#id_name\").val(obj.name);\n\n                            // TODO: eventtype does not yet work correctly.\n                            $(\"#id_eventtype\").val(obj.eventtype);\n\n                            $(\"#id_introeditoreditable\").html(obj.intro);\n                            $('#id_duration').val(obj.duration);\n                            $('#id_points').val(obj.points);\n                            $('#id_organizatorname').val(obj.organizatorname);\n                            $('#id_pollurl').val(obj.pollurl);\n                            $('#id_pollurlteachers').val(obj.pollurlteachers);\n                            // TODO: attachment - is this even possible?\n                            // TODO: Views to show in the booking options overview.\n                            $('#id_whichview').val(obj.whichview);\n                            $('#id_defaultoptionsort').val(obj.defaultoptionsort);\n                            $('#id_enablepresence').val(obj.enablepresence);\n                            $('#id_templateid').val(obj.templateid);\n                            $('#id_showdescriptionmode').val(obj.showdescriptionmode);\n                            $('#id_showlistoncoursepage').val(obj.showlistoncoursepage);\n                            $('#id_coursepageshortinfo').val(obj.coursepageshortinfo);\n                            // Known issue: coursepageshortinfo won't be unhidden when filled from template.\n\n                            // Confirmation e-mail settings\n                            $('#id_sendmail').val(obj.sendmail);\n                            $('#id_copymail').val(obj.copymail);\n                            $('#id_sendmailtobooker').val(obj.sendmailtobooker);\n                            $('#id_daystonotify').val(obj.daystonotify);\n                            $('#id_daystonotify2').val(obj.daystonotify2);\n                            $('#id_daystonotifyteachers').val(obj.daystonotifyteachers);\n                            // TODO: bookingmanager\n                            $('#id_mailtemplatessource').val(obj.mailtemplatessource);\n                            $('#id_bookedtexteditable').html(obj.bookedtext);\n                            $('#id_waitingtexteditable').html(obj.waitingtext);\n                            $('#id_notifyemaileditable').html(obj.notifyemail);\n                            $('#id_notifyemailteacherseditable').html(obj.notifyemailteachers);\n                            $('#id_statuschangetexteditable').html(obj.statuschangetext);\n                            $('#id_userleaveeditable').html(obj.userleave);\n                            $('#id_deletedtexteditable').html(obj.deletedtext);\n                            $('#id_bookingchangedtexteditable').html(obj.bookingchangedtext);\n                            $('#id_pollurltexteditable').html(obj.pollurltext);\n                            $('#id_pollurlteacherstexteditable').html(obj.pollurlteacherstext);\n                            $('#id_activitycompletiontexteditable').html(obj.activitycompletiontext);\n\n                            // Custom labels\n                            $('#id_btncacname').val(obj.btncacname);\n                            $('#id_lblteachname').val(obj.lblteachname);\n                            $('#id_lblsputtname').val(obj.lblsputtname);\n                            $('#id_btnbooknowname').val(obj.btnbooknowname);\n                            $('#id_btncancelname').val(obj.btncancelname);\n                            $('#id_lblbooking').val(obj.lblbooking);\n                            $('#id_lbllocation').val(obj.lbllocation);\n                            $('#id_lblinstitution').val(obj.lblinstitution);\n                            $('#id_lblname').val(obj.lblname);\n                            $('#id_lblsurname').val(obj.lblsurname);\n                            $('#id_booktootherbooking').val(obj.booktootherbooking);\n                            $('#id_lblacceptingfrom').val(obj.lblacceptingfrom);\n                            $('#id_lblnumofusers').val(obj.lblnumofusers);\n\n                            // Miscellaneous settings\n                            $('#id_bookingpolicyeditable').html(obj.bookingpolicy);\n                            $('#id_cancancelbook').val(obj.cancancelbook);\n                            $('#id_allowupdate').val(obj.allowupdate);\n                            $('#id_allowupdatedays').val(obj.allowupdatedays);\n                            $('#id_autoenrol').val(obj.autoenrol);\n                            $('#id_addtogroup').val(obj.addtogroup);\n                            $('#id_maxperuser').val(obj.maxperuser);\n                            $('#id_showinapi').val(obj.showinapi);\n                            $('#id_numgenerator').val(obj.numgenerator);\n                            $('#id_paginationnum').val(obj.paginationnum);\n                            $('#id_banusernames').val(obj.banusernames);\n                            $('#id_showhelpfullnavigationlinks').val(obj.showhelpfullnavigationlinks);\n                            $('#id_completionmodule').val(obj.completionmodule);\n                            $('#id_comments').val(obj.comments);\n                            $('#id_ratings').val(obj.ratings);\n                            $('#id_removeuseronunenrol').val(obj.removeuseronunenrol);\n\n                            // Category\n                            $(\"#id_categoryid\").val(JSON.parse(\"[\" + obj.categoryid + \"]\"));\n\n                            // TODO: Fields to display in different contexts\n\n                            // Booking option text depending on booking status\n                            $('#id_beforecompletedtexteditable').html(obj.beforecompletedtext);\n                            $('#id_aftercompletedtexteditable').html(obj.aftercompletedtext);\n                            $('#id_beforebookedtexteditable').html(obj.beforebookedtext);\n\n                            // TODO: Sign-In Sheet Configuration\n                            // $(\"#id_signinsheetfields\").val(JSON.parse(\"[\" + obj.signinsheetfields + \"]\")).change();\n\n                            // TO-DO :Create backup!\n                            // TO-DO: Fields still to add:\n                            // - assesstimefinish\n                            // - assesstimestart\n                            // - course\n                            // - enablecompletion\n                            // - optionsfields\n                            // - reportfields\n                            // - responsesfields\n                            // - scale\n                            // - signinsheetfields\n                            // - timeclose\n                            // - timemodified\n                            // - timeopen\n\n                            // Connected booking\n                            $('#id_conectedbooking').val(obj.conectedbooking);\n\n                            // Teachers\n                            $('#id_teacherroleid').val(obj.teacherroleid);\n\n                            // TODO: Custom report templates\n                            // TODO: Automatic booking option creation\n\n                            // Ratings\n                            $('#id_assessed').val(obj.assessed);\n\n                            // TODO: Common module settings\n                            // TODO: Restrict access (possible?)\n                            // TODO: Activity completion\n                            // TODO: Competencies\n                        }\n                    }], true);\n                }\n            });\n        }\n    };\n});\n"],"names":["define","$","ajax","init","change","val","call","methodname","args","id","done","data","obj","parseJSON","template","name","eventtype","html","intro","duration","points","organizatorname","pollurl","pollurlteachers","whichview","defaultoptionsort","enablepresence","templateid","showdescriptionmode","showlistoncoursepage","coursepageshortinfo","sendmail","copymail","sendmailtobooker","daystonotify","daystonotify2","daystonotifyteachers","mailtemplatessource","bookedtext","waitingtext","notifyemail","notifyemailteachers","statuschangetext","userleave","deletedtext","bookingchangedtext","pollurltext","pollurlteacherstext","activitycompletiontext","btncacname","lblteachname","lblsputtname","btnbooknowname","btncancelname","lblbooking","lbllocation","lblinstitution","lblname","lblsurname","booktootherbooking","lblacceptingfrom","lblnumofusers","bookingpolicy","cancancelbook","allowupdate","allowupdatedays","autoenrol","addtogroup","maxperuser","showinapi","numgenerator","paginationnum","banusernames","showhelpfullnavigationlinks","completionmodule","comments","ratings","removeuseronunenrol","JSON","parse","categoryid","beforecompletedtext","aftercompletedtext","beforebookedtext","conectedbooking","teacherroleid","assessed"],"mappings":"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"}