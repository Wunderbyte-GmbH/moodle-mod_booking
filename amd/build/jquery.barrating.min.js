"function"==typeof define&&define.amd&&define("mod_booking/jquery.barrating",["jquery"],(function($){var BarRating=function(){function BarRating(){var self=this,wrapElement=function(){var classes=["br-wrapper"];""!==self.options.theme&&classes.push("br-theme-"+self.options.theme),self.$elem.wrap($("<div />",{class:classes.join(" ")}))},unwrapElement=function(){self.$elem.unwrap()},findOption=function(value){return $.isNumeric(value)&&(value=Math.floor(value)),$('option[value="'+value+'"]',self.$elem)},getInitialOption=function(){var initialRating=self.options.initialRating;return initialRating?findOption(initialRating):$("option:selected",self.$elem)},getEmptyOption=function(){var $emptyOpt=self.$elem.find('option[value="'+self.options.emptyValue+'"]');return!$emptyOpt.length&&self.options.allowEmpty?($emptyOpt=$("<option />",{value:self.options.emptyValue})).prependTo(self.$elem):$emptyOpt},getData=function(key){var data=self.$elem.data("barrating");return void 0!==key?data[key]:data},setData=function(key,value){null!==value&&"object"==typeof value?self.$elem.data("barrating",value):self.$elem.data("barrating")[key]=value},saveDataOnElement=function(){var $opt=getInitialOption(),$emptyOpt=getEmptyOption(),value=$opt.val(),text=$opt.data("html")?$opt.data("html"):$opt.text(),allowEmpty=null!==self.options.allowEmpty?self.options.allowEmpty:!!$emptyOpt.length,emptyValue=$emptyOpt.length?$emptyOpt.val():null,emptyText=$emptyOpt.length?$emptyOpt.text():null;setData(null,{userOptions:self.options,ratingValue:value,ratingText:text,originalRatingValue:value,originalRatingText:text,allowEmpty:allowEmpty,emptyRatingValue:emptyValue,emptyRatingText:emptyText,readOnly:self.options.readonly,ratingMade:!1})},removeDataOnElement=function(){self.$elem.removeData("barrating")},ratingText=function(){return getData("ratingText")},ratingValue=function(){return getData("ratingValue")},buildWidget=function(){var $w=$("<div />",{class:"br-widget"});return self.$elem.find("option").each((function(){var val,text,html,$a;(val=$(this).val())!==getData("emptyRatingValue")&&(text=$(this).text(),(html=$(this).data("html"))&&(text=html),$a=$("<a />",{href:"#","data-rating-value":val,"data-rating-text":text,html:self.options.showValues?text:""}),$w.append($a))})),self.options.showSelectedRating&&$w.append($("<div />",{text:"",class:"br-current-rating"})),self.options.reverse&&$w.addClass("br-reverse"),self.options.readonly&&$w.addClass("br-readonly"),$w},nextAllorPreviousAll=function(){return getData("userOptions").reverse?"nextAll":"prevAll"},setSelectFieldValue=function(value){findOption(value).prop("selected",!0),getData("userOptions").triggerChange&&self.$elem.change()},resetSelectField=function(){$("option",self.$elem).prop("selected",(function(){return this.defaultSelected})),getData("userOptions").triggerChange&&self.$elem.change()},showSelectedRating=function(text){(text=text||ratingText())==getData("emptyRatingText")&&(text=""),self.options.showSelectedRating&&self.$elem.parent().find(".br-current-rating").text(text)},fraction=function(value){return Math.round(Math.floor(10*value)/10%1*100)},resetStyle=function(){self.$widget.find("a").removeClass((function(index,classes){return(classes.match(/(^|\s)br-\S+/g)||[]).join(" ")}))},applyStyle=function(){var $all,$fractional,$a=self.$widget.find('a[data-rating-value="'+ratingValue()+'"]'),initialRating=getData("userOptions").initialRating,baseValue=$.isNumeric(ratingValue())?ratingValue():0,f=fraction(initialRating);if(resetStyle(),$a.addClass("br-selected br-current")[nextAllorPreviousAll()]().addClass("br-selected"),!getData("ratingMade")&&$.isNumeric(initialRating)){if(initialRating<=baseValue||!f)return;$all=self.$widget.find("a"),($fractional=$a.length?$a[getData("userOptions").reverse?"prev":"next"]():$all[getData("userOptions").reverse?"last":"first"]()).addClass("br-fractional"),$fractional.addClass("br-fractional-"+f)}},isDeselectable=function($element){return!(!getData("allowEmpty")||!getData("userOptions").deselectable)&&ratingValue()==$element.attr("data-rating-value")},attachClickHandler=function($elements){$elements.on("click.barrating",(function(event){var value,text,$a=$(this),options=getData("userOptions");return event.preventDefault(),value=$a.attr("data-rating-value"),text=$a.attr("data-rating-text"),isDeselectable($a)&&(value=getData("emptyRatingValue"),text=getData("emptyRatingText")),setData("ratingValue",value),setData("ratingText",text),setData("ratingMade",!0),setSelectFieldValue(value),showSelectedRating(text),applyStyle(),options.onSelect.call(self,ratingValue(),ratingText(),event),!1}))},attachMouseEnterHandler=function($elements){$elements.on("mouseenter.barrating",(function(){if(!self.options.initialRating){var $a=$(this);resetStyle(),$a.addClass("br-active")[nextAllorPreviousAll()]().addClass("br-active"),showSelectedRating($a.attr("data-rating-text"))}}))},attachMouseLeaveHandler=function(){self.$widget.on("mouseleave.barrating blur.barrating",(function(){showSelectedRating(),applyStyle()}))},fastClicks=function($elements){$elements.on("touchstart.barrating",(function(event){event.preventDefault(),event.stopPropagation(),$(this).click()}))},disableClicks=function($elements){$elements.on("click.barrating",(function(event){event.preventDefault()}))},attachHandlers=function($elements){attachClickHandler($elements),self.options.hoverState&&(attachMouseEnterHandler($elements),attachMouseLeaveHandler($elements))},detachHandlers=function($elements){$elements.off(".barrating")},setupHandlers=function(readonly){var $elements=self.$widget.find("a");getData("userOptions").fastClicks&&fastClicks($elements),readonly?(detachHandlers($elements),disableClicks($elements)):attachHandlers($elements)};this.show=function(){getData()||(wrapElement(),saveDataOnElement(),self.$widget=buildWidget(),self.$widget.insertAfter(self.$elem),applyStyle(),showSelectedRating(),setupHandlers(self.options.readonly),self.$elem.hide())},this.readonly=function(state){"boolean"==typeof state&&getData("readOnly")!=state&&(setupHandlers(state),setData("readOnly",state),self.$widget.toggleClass("br-readonly"))},this.set=function(value){var options=getData("userOptions");0!==self.$elem.find('option[value="'+value+'"]').length&&(setData("ratingValue",value),setData("ratingText",self.$elem.find('option[value="'+value+'"]').text()),setData("ratingMade",!0),setSelectFieldValue(ratingValue()),showSelectedRating(ratingText()),applyStyle(),options.silent||options.onSelect.call(this,ratingValue(),ratingText()))},this.clear=function(){var options=getData("userOptions");setData("ratingValue",getData("originalRatingValue")),setData("ratingText",getData("originalRatingText")),setData("ratingMade",!1),resetSelectField(),showSelectedRating(ratingText()),applyStyle(),options.onClear.call(this,ratingValue(),ratingText())},this.destroy=function(){var value=ratingValue(),text=ratingText(),options=getData("userOptions");detachHandlers(self.$widget.find("a")),self.$widget.remove(),removeDataOnElement(),unwrapElement(),self.$elem.show(),options.onDestroy.call(this,value,text)}}return BarRating.prototype.init=function(options,elem){return this.$elem=$(elem),this.options=$.extend({},$.fn.barrating.defaults,options),this.options},BarRating}();$.fn.barrating=function(method,options){return this.each((function(){var plugin=new BarRating;if($(this).is("select")||$.error("Sorry, this plugin only works with select fields."),plugin.hasOwnProperty(method)){if(plugin.init(options,this),"show"===method)return plugin.show(options);if(plugin.$elem.data("barrating"))return plugin.$widget=$(this).next(".br-widget"),plugin[method](options)}else{if("object"==typeof method||!method)return options=method,plugin.init(options,this),plugin.show();$.error("Method "+method+" does not exist on jQuery.barrating")}}))},$.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:!1,showSelectedRating:!0,deselectable:!0,reverse:!1,readonly:!1,fastClicks:!0,hoverState:!0,silent:!1,triggerChange:!0,onSelect:function(value,text,event){},onClear:function(value,text){},onDestroy:function(value,text){}},$.fn.barrating.BarRating=BarRating}));

//# sourceMappingURL=jquery.barrating.min.js.map